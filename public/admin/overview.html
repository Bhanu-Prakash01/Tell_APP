<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Admin â€¢ Overview</title>
	<link rel="stylesheet" href="../assets/frappe.css" />
</head>
<body>
	<div class="admin-shell">
		<aside class="admin-sidebar">
			<div class="brand"><h1>TeleCRM Admin</h1></div>
			<nav>
				<a href="/admin/overview.html" class="active">Overview</a>
				<a href="/admin/users.html">Users</a>
				<a href="/admin/leads.html">Leads</a>
				<a href="/admin/call-records.html">Call Records</a>
				<a href="/admin/settings.html">Settings</a>
				<!-- <a href="/admin/mailbox.html">Mailbox</a> -->
			</nav>
		</aside>
		<main class="admin-main">
			<div class="admin-topbar">
				<h2 class="page-title">Overview</h2>
				<div class="toolbar">
					<button class="btn btn-outline" onclick="toggleSidebar()">Toggle Sidebar</button>
					<button class="btn" id="refreshBtn">Refresh</button>
					<button class="btn btn-outline" id="themeToggle" title="Toggle Theme">Theme</button>
					<a class="btn btn-outline" href="/login.html" onclick="logout(event)">Logout</a>
				</div>
			</div>
			<div class="grid cols-4" id="metrics" style="align-items:stretch">
				<div class="card"><div>Total Users</div><h3 id="mUsers">-</h3></div>
				<div class="card"><div>Total Leads</div><h3 id="mLeads">-</h3></div>
				<div class="card"><div>Total Calls</div><h3 id="mCalls">-</h3></div>
			</div>
			<!-- Charts removed per requirements for a cleaner UI without charts -->
		</main>
	</div>
	<script src="../assets/admin.js"></script>
	<script>
		Admin.navActivate('/admin/overview.html');
		function toggleSidebar(){
			const sb = document.querySelector('.admin-sidebar');
			sb && sb.classList.toggle('open');
		}
		function logout(e){
			e && e.preventDefault();
			try {
				localStorage.removeItem('token');
				localStorage.removeItem('role');
			} catch(_){ }
			window.location.href = '/login.html';
		}

		// Theme management (light / semi / dark)
		function initializeTheme(){
			const saved = localStorage.getItem('uiTheme') || 'light';
			setTheme(saved);
			const tBtn = document.getElementById('themeToggle');
			if(tBtn){ tBtn.addEventListener('click', toggleTheme); }
		}
		function setTheme(theme){
			const html = document.documentElement;
			html.classList.remove('theme-semi','theme-dark');
			if(theme==='semi') html.classList.add('theme-semi');
			if(theme==='dark') html.classList.add('theme-dark');
			localStorage.setItem('uiTheme', theme);
		}
		function toggleTheme(){
			const cur = localStorage.getItem('uiTheme') || 'light';
			const next = cur==='light' ? 'semi' : (cur==='semi' ? 'dark' : 'light');
			setTheme(next);
		}

		async function loadDashboard(){
			const res = await fetch('/api/admin/performance/dashboard',{ headers: Admin.authHeaders() });
			if(!res.ok) return;
			const d = await res.json();
			document.getElementById('mUsers').textContent = d.totalUsers||0;
			document.getElementById('mLeads').textContent = d.totalLeads||0;
			document.getElementById('mCalls').textContent = d.totalCalls||0;
			document.getElementById('mSims').textContent = d.activeSims||0;
		}
		document.getElementById('refreshBtn').addEventListener('click', loadDashboard);
		if(Admin.getToken()){ initializeTheme(); loadDashboard(); }
	</script>
</body>
</html>
